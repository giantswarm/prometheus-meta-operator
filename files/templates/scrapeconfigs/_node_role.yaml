[[- define "_node_role" -]]
# Add role label.
- source_labels: [__meta_kubernetes_node_label_role]
  target_label: role
# Add a temporary label.
- source_labels: [ __address__ ] # using address because I need this replacement to always happen.
  target_label: default_role
  replacement: worker
# If role is empty, we default to worker
- source_labels: [role, default_role]
  separator: ;
  regex: ';(.*)'
  target_label: role
  replacement: $1
[[- end -]]
